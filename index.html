<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>"Canvas" Scrolling Game</title>
    
  </head>
  <body>
    <canvas id="canvas" width="500" height="500"></canvas>


  <script>
      // VARIABLES
    let c = document.querySelector("#canvas");
    let ctx = c.getContext("2d");
      
    let background = new Image();                  
      background.src =
          "https://webgradients.com/public/webgradients_png/008%20Rainy%20Ashville.png";
      
      let bgClouds = new Image();
        bgClouds.src =
          "clouds1.png";
      
      let fgClouds = new Image();
        fgClouds.src =
          "clouds2.png";
    
      // GAME DICTIONARIES                         // FIXME: adjust numbers after basic structure set
    let player = {x:100, y:100, radius:10};
    let benefit = {x:200, y:300, radius:20};
    let harm = {x:300, y:400, radius:30};
    let game = {score: 0, lives: 3, level: 1};
    let cloudsBack = {x:0, y:0};
    let cloudsFront = {x:450, y:200};
    
      // FUNCTIONS // 

      // FIXME: revise how to implement python collision into JS -----------------------------
      //     and change to detect image collision 
      function are_colliding(obj1, obj2) {
          let collision = false;
        
          let radii_sum = obj1["radius"] + obj2["radius"];
          let dx = obj1["x"] - obj2["x"]; // check coordinate thing
          let dy = obj1["y"] - obj2["y"];    
          let distance = Math.sqrt(dx*dx + dy*dy);
    
          if ( distance < radii_sum ) {
            collision = true;
          }
          
          return collision;
      }
      // -------------------------------------------------------------------------------------
      
      function gameOverScreen() {
          // clear screen
          // print message
          // print score
          // option to start again
      }
      
      function moveUp() {
          player["y"] += 1
      }
      function moveDown() {
          player["y"] -= 1
      }
      

    const draw = () => {
        
      // clear
      ctx.clearRect (0,0, c.width, c.height);
        
      // draw background 
      ctx.drawImage(background, 0, 0, c.width, c.height);
        ctx.drawImage(bgClouds, cloudsBack["x"], cloudsBack["y"], c.width*2, c.height*2);
        ctx.drawImage(fgClouds, cloudsFront["x"], cloudsBack["y"], c.width/2, c.height/2);

      // update values
      harm["x"] -= 5;                                        // FIXME: add "speed" to dict. -> update
      benefit["x"] -= 3;
        
      cloudsBack["x"] -= 2;
      cloudsFront["x"] -= 1;
        

      // handle edge conditions                              // FIXME: fix bounds?
      if (harm["x"] < -harm["radius"]) {                     // if out of bounds
        harm["x"] = harm["radius"] + c.width;                // reset x coord & 
        harm["y"] = Math.floor(Math.random() * 480 + 20);    // random y coord
      }
      
      if (benefit["x"] < -benefit["radius"]) {
        benefit["x"] = benefit["radius"] + c.width
        benefit["y"] = Math.floor(Math.random() * 480 + 20);
      }
        
      if (cloudsFront["x"] < -800) {
        cloudsFront["x"] = c.width - 100
        cloudsFront["y"] = Math.floor(Math.random() * 480 + 20);
      }
        
      if (cloudsBack["x"] < -800) {
        cloudsBack["x"] = c.width - 100
        cloudsBack["y"] = Math.floor(Math.random() * 480 + 20);
      }

      // draw harm object
      ctx.beginPath();
      ctx.arc(harm["x"],harm["y"],harm["radius"],0, Math.PI*2);
      ctx.closePath();
      ctx.fillStyle = "orange";
      ctx.fill();
        
      // draw benefit object
      ctx.beginPath();
      ctx.arc(benefit["x"],benefit["y"],benefit["radius"],0, Math.PI*2);
      ctx.closePath();
      ctx.fillStyle = "green";
      ctx.fill();
        
      // draw player object
      ctx.beginPath();
      ctx.arc(player["x"],player["y"],player["radius"],0, Math.PI*2);
      ctx.closePath();
      ctx.fillStyle = "cyan";
      ctx.fill();
        
      // display     Lives,    Score,    and Level
      ctx.fillStyle = "blue";
      ctx.fillText("Lives: " + game["lives"], 450,25);
      ctx.fillText("Score: " + game["score"], 25,25);
      ctx.fillText("Level: " + game["level"], 25,45);
        
      // EVENT HANDLERS                                         // FIXME: function syntax?
      // UP
//       ctx.addEventListener("ArrowUp", moveUp);
        //window.addEventListener("KeyW", moveUp());
        
      // DOWN
//       ctx.addEventListener("ArrowDown", moveDown);
        //window.addEventListener("KeyS", moveDown());
        
      // repeat
      window.requestAnimationFrame(draw);
    }

    draw();        // FIXME: change game-loop-structure once instructions and game-over screen decided 
  </script>


  </body>
</html>